<script>
    const apiUrl = 'https://api.seniverse.com/v3/weather/now.json?key=SRcP96opaDD9zO9_1&location=xiamen&language=zh-Hans&unit=c'

    async function fetchData(apiUrl){
        try{
            const response = await fetch(apiUrl);
            if(!response.ok){
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            const data = await response.json();
            console.log('获取的数据',data);
            return data;
        }catch(error){
            console.error('Error:', error);
        }
    }

    async function updateWeather(){
        const weatherData = await fetchData(apiUrl);
        const weatherSpan = document.getElementById('weather-display');
        
        if (weatherData && weatherData.results && weatherData.results[0]) {
            const result = weatherData.results[0];
            let weatherMain = null;
            switch(result.now.code){
                case '1': weatherMain = '晴';break;
                case '1': weatherMain = '夜晚晴';break;
                default: weatherMain = '未知';break;
            }
            const weatherInfo = `
                城市: ${result.location.name}
                国家: ${result.location.country}
                天气码: ${result.now.code}
                天气: ${weatherMain}
                温度: ${result.now.temperature}℃
            `;
            weatherSpan.textContent = weatherInfo;
        } else {
            weatherSpan.textContent = '无法获取天气数据';
        }

        
    }
    
    updateWeather();
</script>

<span id="weather-display" style="white-space: pre-wrap;">
   <y-tooltip class="item" effect="dark"placement="top">
    <y-icon
      style="position:relative;top:7px;margin-right:10px"
      class="icon-class"
    ></y-icon>
  </y-tooltip>
</span>
